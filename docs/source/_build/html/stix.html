

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CTI Python STIX &mdash; attackcti 0.2.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ATTACK CTI Overview" href="attackcti_overview.html" />
    <link rel="prev" title="CTI TAXII Client" href="taxii_client.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> attackcti
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">OASIS CTI TC</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="oasis_overview.html">OASIS Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="taxii_client.html">CTI TAXII Client</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">CTI STIX</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-is-stix">What is STIX?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stix-objects">STIX Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stix-att-ck">STIX &amp; ATT&amp;CK</a></li>
<li class="toctree-l2"><a class="reference internal" href="#query-att-ck">Query ATT&amp;CK</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">ATTACK CTI Library:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="attackcti_overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="attackcti_functions.html">Functions</a></li>
</ul>
<p class="caption"><span class="caption-text">Licenses:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="license.html">GNU General Public License V3</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">attackcti</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>CTI Python STIX</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/stix.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cti-python-stix">
<h1>CTI Python STIX<a class="headerlink" href="#cti-python-stix" title="Permalink to this headline">¶</a></h1>
<p>The cti-python-stix2 library was developed by MITRE to help users serialize/de-serialize, produce, consume, and process STIX 2 content.</p>
<div class="section" id="what-is-stix">
<h2>What is STIX?<a class="headerlink" href="#what-is-stix" title="Permalink to this headline">¶</a></h2>
<p>Structured Threat Information Expression (STIX™) is a language and serialization format used to exchange cyber threat intelligence (CTI).</p>
</div>
<div class="section" id="stix-objects">
<h2>STIX Objects<a class="headerlink" href="#stix-objects" title="Permalink to this headline">¶</a></h2>
<p>STIX Objects categorize each piece of information with specific attributes to be populated.
Chaining multiple objects together through relationships allow for easy or complex representations of CTI.</p>
<ul class="simple">
<li><p><strong>Attack Pattern</strong>: A type of Tactics, Techniques, and Procedures (TTP) that describes ways threat actors attempt to compromise targets.</p></li>
<li><p><strong>Campaign</strong>: A grouping of adversarial behaviors that describes a set of malicious activities or attacks that occur over a period of time against a specific set of targets.</p></li>
<li><p><strong>Course of Action</strong>: An action taken to either prevent an attack or respond to an attack.</p></li>
<li><p><strong>Identity</strong>: Individuals, organizations, or groups, as well as classes of individuals, organizations, or groups.</p></li>
<li><p><strong>Indicator</strong>: Contains a pattern that can be used to detect suspicious or malicious cyber activity.</p></li>
<li><p><strong>Intrusion Set</strong>: A grouped set of adversarial behaviors and resources with common properties believed to be orchestrated by a single threat actor.</p></li>
<li><p><strong>Malware</strong>: A type of TTP, also known as malicious code and malicious software, used to compromise the confidentiality, integrity, or availability of a victim’s data or system.</p></li>
<li><p><strong>Observed Data</strong>: Conveys information observed on a system or network (e.g., an IP address).</p></li>
<li><p><strong>Report</strong>: Collections of threat intelligence focused on one or more topics, such as a description of a threat actor, malware, or attack technique, including contextual details.</p></li>
<li><p><strong>Threat Actor</strong>: Individuals, groups, or organizations believed to be operating with malicious intent.</p></li>
<li><p><strong>Tool</strong>: Legitimate software that can be used by threat actors to perform attacks.</p></li>
<li><p><strong>Vulnerability</strong>: A mistake in software that can be directly used by a hacker to gain access to a system or network.</p></li>
</ul>
<p>STIX also defines two relationship objects (SROs)</p>
<ul class="simple">
<li><p>Relationship: Used to link two SDOs and to describe how they are related to each other.</p></li>
<li><p>Sighting: Denotes the belief that an element of CTI was seen (e.g., indicator, malware).</p></li>
</ul>
</div>
<div class="section" id="stix-att-ck">
<h2>STIX &amp; ATT&amp;CK<a class="headerlink" href="#stix-att-ck" title="Permalink to this headline">¶</a></h2>
<p>The ATT&amp;CK framework is now available on a public TAXII server, and the content is in STIX2 format.
Therefore, the ATT&amp;Ck team had to map/translate ATT&amp;CK objects and properties to STIX 2.0 objects and properties syntax.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 44%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ATT&amp;CK Concept</p></th>
<th class="head"><p>STIX Object Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Technique</p></td>
<td><p>attack-pattern</p></td>
</tr>
<tr class="row-odd"><td><p>Group</p></td>
<td><p>intrusion-set</p></td>
</tr>
<tr class="row-even"><td><p>Software</p></td>
<td><p>malware or tool</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>course-of-action</p></td>
</tr>
<tr class="row-even"><td><p>Tactic</p></td>
<td><p>x-mitre-tractic</p></td>
</tr>
<tr class="row-odd"><td><p>Matrix</p></td>
<td><p>x-mitre-matrix</p></td>
</tr>
</tbody>
</table>
<p>You can learn more about the mapping concepts <a class="reference external" href="https://github.com/mitre/cti/blob/master/USAGE.md#mapping-concepts">here</a>.</p>
<p>Even though ATT&amp;CK content can be retrieved from its public TAXII server via its own taxii client python library, the cti-taxii-client was developed to consume and process the STIX content in a more efficient way.
The <code class="docutils literal notranslate"><span class="pre">get_object</span></code> method from the TAXII client library works well if you already have a specific id of a STIX object.
However, the cti-python-stix2 library provides a more dynamic and flexible filtering capability to retrieve ATT&amp;CK content by specific STIX objects such as <code class="docutils literal notranslate"><span class="pre">attack-patterns</span></code>, <code class="docutils literal notranslate"><span class="pre">intrusion-set</span></code>, <code class="docutils literal notranslate"><span class="pre">x-mitre-matrix</span></code>, etc.</p>
<p>ATT&amp;CK users can use the cti-python-stix2 library to retrieve STIX 2.0 data, but they must first reference a STIX <code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">Source</span></code>.</p>
<ul class="simple">
<li><p>Data Sources represent locations from which STIX data can be retrieved.</p></li>
<li><p>The STIX library comes with a TAXIICollection suite that contains TAXIICollectionStore, TAXIICollectionSource, and TAXIICollectionSink classes.</p></li>
<li><p>The TAXIICollection suite supports searching on all STIX2 common object properties. This works simply by augmenting the filtering that is done remotely at the TAXII2 server instance.</p></li>
<li><p>The TAXIICollection will seperate any supplied queries into TAXII supported filters and non-supported filters.</p></li>
<li><p>During a TAXIICollection API call, TAXII2 supported filters get inserted into the TAXII2 server request (to be evaluated at the server). The rest of the filters are kept locally and then applied to the STIX2 content that is returned from the TAXII2 server, before being returned from the TAXIICollection API call.</p></li>
<li><p>The TAXIICollectionSource class retrieves STIX content from local/remote TAXII Collection(s)</p></li>
<li><p>The TAXIICollectionSource class can be used with a <code class="docutils literal notranslate"><span class="pre">Collection</span></code> object that can be instantiated by the taxii client library.</p></li>
</ul>
</div>
<div class="section" id="query-att-ck">
<h2>Query ATT&amp;CK<a class="headerlink" href="#query-att-ck" title="Permalink to this headline">¶</a></h2>
<p>ATT&amp;CK users can use the taxii client and stix libraries together to reference specific STIX objects available in the public ATT&amp;CK TAXII server:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stix2</span> <span class="kn">import</span> <span class="n">TAXIICollectionSource</span><span class="p">,</span> <span class="n">Filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">taxii2client</span> <span class="kn">import</span> <span class="n">Collection</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ATTCK_STIX_COLLECTIONS</span> <span class="o">=</span> <span class="s2">&quot;https://cti-taxii.mitre.org/stix/collections/&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ENTERPRISE_ATTCK</span> <span class="o">=</span> <span class="s2">&quot;95ecc380-afe9-11e4-9b6c-751b66dd541e&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PRE_ATTCK</span> <span class="o">=</span> <span class="s2">&quot;062767bd-02d2-4b72-84ba-56caef0f8658&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MOBILE_ATTCK</span> <span class="o">=</span> <span class="s2">&quot;2f669986-b40b-4423-b720-4396ca6a462b&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ENTERPRISE_COLLECTION</span> <span class="o">=</span> <span class="n">Collection</span><span class="p">(</span><span class="n">ATTCK_STIX_COLLECTIONS</span> <span class="o">+</span> <span class="n">ENTERPRISE_ATTCK</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TC_ENTERPRISE_SOURCE</span> <span class="o">=</span> <span class="n">TAXIICollectionSource</span><span class="p">(</span><span class="n">ENTERPRISE_COLLECTION</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">PRE_COLLECTION</span> <span class="o">=</span> <span class="n">Collection</span><span class="p">(</span><span class="n">ATTCK_STIX_COLLECTIONS</span> <span class="o">+</span> <span class="n">PRE_ATTCK</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TC_PRE_SOURCE</span> <span class="o">=</span> <span class="n">TAXIICollectionSource</span><span class="p">(</span><span class="n">PRE_COLLECTION</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">MOBILE_COLLECTION</span> <span class="o">=</span> <span class="n">Collection</span><span class="p">(</span><span class="n">ATTCK_STIX_COLLECTIONS</span> <span class="o">+</span> <span class="n">MOBILE_ATTCK</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TC_MOBILE_SOURCE</span> <span class="o">=</span> <span class="n">TAXIICollectionSource</span><span class="p">(</span><span class="n">MOBILE_COLLECTION</span><span class="p">)</span>
</pre></div>
</div>
<p>We can then use the <code class="docutils literal notranslate"><span class="pre">Filter</span></code> class available in STIX to retrieve multiple objects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">enterprise_stix_objects</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enterprise_filter_objects</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span><span class="s2">&quot;techniques&quot;</span><span class="p">:</span> <span class="n">Filter</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;attack-pattern&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="s2">&quot;mitigations&quot;</span><span class="p">:</span> <span class="n">Filter</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;course-of-action&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="s2">&quot;groups&quot;</span><span class="p">:</span> <span class="n">Filter</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;intrusion-set&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="s2">&quot;malware&quot;</span><span class="p">:</span> <span class="n">Filter</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;malware&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="n">Filter</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;tool&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="s2">&quot;relationships&quot;</span><span class="p">:</span> <span class="n">Filter</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;relationship&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">enterprise_filter_objects</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">enterprise_stix_objects</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_ENTERPRISE_SOURCE</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">enterprise_filter_objects</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
<p>You can learn more about <strong>Filters</strong> <a class="reference external" href="https://stix2.readthedocs.io/en/latest/api/datastore/stix2.datastore.filters.html">here</a>.</p>
<p>We can now display the first element in the list of <code class="docutils literal notranslate"><span class="pre">techniques</span></code> of the <code class="docutils literal notranslate"><span class="pre">enterprise_stix_objects</span></code> dictionary and validate that we were able to retrieve data from ATT&amp;CK public TAXII server:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">enterprise_stix_objects</span><span class="p">[</span><span class="s2">&quot;techniques&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="go">AttackPattern(</span>
<span class="go">    type=&#39;attack-pattern&#39;,</span>
<span class="go">    id=&#39;attack-pattern--cf7b3a06-8b42-4c33-bbe9-012120027925&#39;,</span>
<span class="go">    created_by_ref=&#39;identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5&#39;,</span>
<span class="go">    created=&#39;2019-04-25T20:53:07.719Z&#39;,</span>
<span class="go">    modified=&#39;2019-04-29T21:13:49.686Z&#39;,</span>
<span class="go">    name=&#39;Compile After Delivery&#39;,</span>
<span class="go">    description=&#39;Adversaries may attempt to make payloads difficult to discover and analyze by delivering files to victims as uncompiled code. Similar to [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027),</span>
<span class="go">    text-based source code files may subvert analysis and scrutiny from protections targeting executables/binaries. These payloads will need to be compiled before execution; typically via native utilities such as csc.exe or GCC/MinGW.(Citation: ClearSky MuddyWater Nov 2018)\n\nSource code payloads may also be encrypted, encoded, and/or embedded within other files, such as those delivered as a [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193).</span>
<span class="go">    Payloads may also be delivered in formats unrecognizable and inherently benign to the native OS (ex: EXEs on macOS/Linux) before later being (re)compiled into a proper executable binary with a bundled compiler and execution framework.(Citation: TrendMicro WindowsAppMac)\n&#39;,</span>
<span class="go">    kill_chain_phases=[KillChainPhase(kill_chain_name=&#39;mitre-attack&#39;, phase_name=&#39;defense-evasion&#39;)],</span>
<span class="go">    external_references=[</span>
<span class="go">        ExternalReference(</span>
<span class="go">            source_name=&#39;mitre-attack&#39;,</span>
<span class="go">            url=&#39;https://attack.mitre.org/techniques/T1500&#39;,</span>
<span class="go">            external_id=&#39;T1500&#39;</span>
<span class="go">        ),</span>
<span class="go">        ExternalReference(</span>
<span class="go">            source_name=&#39;ClearSky MuddyWater Nov 2018&#39;,</span>
<span class="go">            description=&#39;ClearSky Cyber Security. (2018, November). MuddyWater Operations in Lebanon and Oman: Using an Israeli compromised domain for a two-stage campaign. Retrieved November 29, 2018.&#39;,</span>
<span class="go">            url=&#39;https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf&#39;</span>
<span class="go">        ),</span>
<span class="go">        ExternalReference(</span>
<span class="go">            source_name=&#39;TrendMicro WindowsAppMac&#39;,</span>
<span class="go">            description=&#39;Trend Micro. (2019, February 11). Windows App Runs on Mac, Downloads Info Stealer and Adware. Retrieved April 25, 2019.&#39;,</span>
<span class="go">            url=&#39;https://blog.trendmicro.com/trendlabs-security-intelligence/windows-app-runs-on-mac-downloads-info-stealer-and-adware/&#39;</span>
<span class="go">        )</span>
<span class="go">    ],</span>
<span class="go">    object_marking_refs=[&#39;marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168&#39;],</span>
<span class="go">    x_mitre_contributors=[&#39;Ye Yint Min Thu Htut, Offensive Security Team, DBS Bank&#39;, &#39;Praetorian&#39;],</span>
<span class="go">    x_mitre_data_sources=[&#39;Process command-line parameters&#39;, &#39;Process monitoring&#39;, &#39;File monitoring&#39;],</span>
<span class="go">    x_mitre_defense_bypassed=[&#39;Static File Analysis&#39;, &#39;Binary Analysis&#39;, &#39;Anti-virus&#39;, &#39;Host intrusion prevention systems&#39;, &#39;Signature-based detection&#39;],</span>
<span class="go">    x_mitre_detection=&#39;Monitor the execution file paths and command-line arguments for common compilers, such as csc.exe and GCC/MinGW, and correlate with other suspicious behavior to reduce false positives from normal user and administrator behavior. The compilation of payloads may also generate file creation and/or file write events. Look for non-native binary formats and cross-platform compiler and execution frameworks like Mono and determine if they have a legitimate purpose on the system.(Citation: TrendMicro WindowsAppMac) Typically these should only be used in specific and limited cases, like for software development.&#39;,</span>
<span class="go">    x_mitre_permissions_required=[&#39;User&#39;],</span>
<span class="go">    x_mitre_platforms=[&#39;Linux&#39;, &#39;macOS&#39;, &#39;Windows&#39;],</span>
<span class="go">    x_mitre_system_requirements=[&#39;Compiler software (either native to the system or delivered by the adversary)&#39;],</span>
<span class="go">    x_mitre_version=&#39;1.0&#39;</span>
<span class="go">)</span>
</pre></div>
</div>
<p>You can also retrieve all the stix objects available for each collection without providing a filter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">enterprise_objects</span> <span class="o">=</span> <span class="n">TC_ENTERPRISE_SOURCE</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">enterprise_objects</span><span class="p">)</span>
<span class="go">&lt;class &#39;list&#39;&gt;</span>
</pre></div>
</div>
<p>You can then use a similar <code class="docutils literal notranslate"><span class="pre">for</span></code> loop and an empty list to capture all the STIX object types and count the number of records per object type:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">enterprise_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">enterprise_objects</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">enterprise_list</span><span class="o">.</span><span class="n">append</span><span class="p">[</span><span class="n">o</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Counter</span><span class="p">(</span><span class="n">enterprise_list</span><span class="p">)</span>
<span class="go">Counter({</span>
<span class="go">    &#39;relationship&#39;: 4852,</span>
<span class="go">    &#39;malware&#39;: 278,</span>
<span class="go">    &#39;attack-pattern&#39;: 244,</span>
<span class="go">    &#39;course-of-action&#39;: 241,</span>
<span class="go">    &#39;intrusion-set&#39;: 88,</span>
<span class="go">    &#39;tool&#39;: 56,</span>
<span class="go">    &#39;x-mitre-tactic&#39;: 12,</span>
<span class="go">    &#39;x-mitre-matrix&#39;: 1,</span>
<span class="go">    &#39;identity&#39;: 1,</span>
<span class="go">    &#39;marking-definition&#39;: 1</span>
<span class="go">})</span>
</pre></div>
</div>
<p>In addition, you can access object properties for each object type and get more information about what is provided:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">object</span> <span class="o">=</span> <span class="n">enterprise_objects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">object</span><span class="o">.</span>
<span class="go">object.add_markings(          object.get_markings(          object.keys(                  object.properties_populated(  object.serialize(</span>
<span class="go">object.clear_markings(        object.is_marked(             object.new_version(           object.remove_markings(       object.set_markings(</span>
<span class="go">object.get(                   object.items(                 object.object_properties(     object.revoke(                object.values(</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">object</span><span class="o">.</span><span class="n">object_properties</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">    &#39;type&#39;,</span>
<span class="go">    &#39;id&#39;,</span>
<span class="go">    &#39;created_by_ref&#39;,</span>
<span class="go">    &#39;created&#39;,</span>
<span class="go">    &#39;modified&#39;,</span>
<span class="go">    &#39;relationship_type&#39;,</span>
<span class="go">    &#39;description&#39;,</span>
<span class="go">    &#39;source_ref&#39;,</span>
<span class="go">    &#39;target_ref&#39;,</span>
<span class="go">    &#39;revoked&#39;,</span>
<span class="go">    &#39;labels&#39;,</span>
<span class="go">    &#39;external_references&#39;,</span>
<span class="go">    &#39;object_marking_refs&#39;,</span>
<span class="go">    &#39;granular_markings&#39;</span>
<span class="go">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">object</span><span class="o">.</span><span class="n">properties_populated</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">    &#39;object_marking_refs&#39;,</span>
<span class="go">    &#39;id&#39;,</span>
<span class="go">    &#39;external_references&#39;,</span>
<span class="go">    &#39;created&#39;,</span>
<span class="go">    &#39;modified&#39;,</span>
<span class="go">    &#39;type&#39;,</span>
<span class="go">    &#39;created_by_ref&#39;,</span>
<span class="go">    &#39;source_ref&#39;,</span>
<span class="go">    &#39;relationship_type&#39;,</span>
<span class="go">    &#39;target_ref&#39;,</span>
<span class="go">    &#39;revoked&#39;</span>
<span class="go">]</span>
</pre></div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.mitre.org/capabilities/cybersecurity/overview/cybersecurity-blog/attck%E2%84%A2-content-available-in-stix%E2%84%A2-20-via">https://www.mitre.org/capabilities/cybersecurity/overview/cybersecurity-blog/attck%E2%84%A2-content-available-in-stix%E2%84%A2-20-via</a></p></li>
<li><p><a class="reference external" href="https://oasis-open.github.io/cti-documentation/stix/intro">https://oasis-open.github.io/cti-documentation/stix/intro</a></p></li>
<li><p><a class="reference external" href="https://docs.google.com/document/d/1IvkLxg_tCnICsatu2lyxKmWmh1gY2h8HUNssKIE-UIA/edit#heading=h.axjijf603msy">https://docs.google.com/document/d/1IvkLxg_tCnICsatu2lyxKmWmh1gY2h8HUNssKIE-UIA/edit#heading=h.axjijf603msy</a></p></li>
<li><p><a class="reference external" href="https://github.com/mitre/cti/blob/master/USAGE.md#mapping-concepts">https://github.com/mitre/cti/blob/master/USAGE.md#mapping-concepts</a></p></li>
<li><p><a class="reference external" href="https://stix2.readthedocs.io/en/latest/overview.html">https://stix2.readthedocs.io/en/latest/overview.html</a></p></li>
<li><p><a class="reference external" href="https://stix2.readthedocs.io/en/latest/api/datastore/stix2.datastore.filters.html">https://stix2.readthedocs.io/en/latest/api/datastore/stix2.datastore.filters.html</a></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="attackcti_overview.html" class="btn btn-neutral float-right" title="ATTACK CTI Overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="taxii_client.html" class="btn btn-neutral float-left" title="CTI TAXII Client" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Roberto Rodriguez @Cyb3rWard0g

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>